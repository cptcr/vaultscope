using VaultScope.Core.Models;

namespace VaultScope.Core.Interfaces;

public interface IVulnerabilityDetector
{
    VulnerabilityType Type { get; }
    
    string Name { get; }
    
    string Description { get; }
    
    Task<List<Vulnerability>> DetectAsync(
        string endpoint, 
        HttpMethod method, 
        AuthenticationResult? authentication = null,
        CancellationToken cancellationToken = default);
    
    bool IsApplicable(string endpoint, HttpMethod method);
    
    int Priority { get; }
}