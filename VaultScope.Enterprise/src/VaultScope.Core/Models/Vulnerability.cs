using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;

namespace VaultScope.Core.Models;

public class Vulnerability
{
    public Guid Id { get; set; } = Guid.NewGuid();
    
    [Required]
    public string Type { get; set; } = string.Empty;
    
    [Required]
    public VulnerabilitySeverity Severity { get; set; }
    
    [Required]
    public string Title { get; set; } = string.Empty;
    
    public string Description { get; set; } = string.Empty;
    
    public string AffectedEndpoint { get; set; } = string.Empty;
    
    public string HttpMethod { get; set; } = string.Empty;
    
    public string? PayloadUsed { get; set; }
    
    public string? Evidence { get; set; }
    
    public string? Remediation { get; set; }
    
    public string? CweId { get; set; }
    
    public string? OwaspCategory { get; set; }
    
    public DateTime DiscoveredAt { get; set; } = DateTime.UtcNow;
    
    public double ConfidenceScore { get; set; }
    
    public Dictionary<string, object> Metadata { get; set; } = new();
}

public enum VulnerabilitySeverity
{
    Informational = 0,
    Low = 1,
    Medium = 2,
    High = 3,
    Critical = 4
}