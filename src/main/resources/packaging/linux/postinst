#!/bin/bash
# VaultScope post-installation script for Debian/Ubuntu

set -e

# Update desktop database
if command -v update-desktop-database >/dev/null 2>&1; then
    update-desktop-database /usr/share/applications
fi

# Update icon cache
if command -v gtk-update-icon-cache >/dev/null 2>&1; then
    gtk-update-icon-cache -f -t /usr/share/icons/hicolor
fi

# Create user data directory
USER_DATA_DIR="/home/$SUDO_USER/.local/share/vaultscope"
if [[ -n "$SUDO_USER" && ! -d "$USER_DATA_DIR" ]]; then
    mkdir -p "$USER_DATA_DIR"
    chown "$SUDO_USER:$SUDO_USER" "$USER_DATA_DIR"
fi

# Create symlink for command line access
if [[ ! -L "/usr/local/bin/vaultscope" ]]; then
    ln -sf /usr/bin/vaultscope /usr/local/bin/vaultscope
fi

# Print installation success message
echo "âœ… VaultScope installed successfully!"
echo "ðŸš€ Launch from Applications menu or run 'vaultscope' in terminal"
echo "ðŸ“– Documentation: https://github.com/cptcr/vaultscope"

exit 0